Windows Registry Editor Version 5.00

; Example template for adding "Open with VS Code" (current user)
; Uses %LOCALAPPDATA% so paths are per-user; encoded as REG_EXPAND_SZ via {{ ... | expandsz }}

; Optional variables (uncomment and provide via -Variables / -Var / -VarsFile):
; Title defaults to "Open with VS Code" if you replace below, e.g.:
; [HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code]
; @="{{ var.Title | regq }}"
; "MUIVerb"="{{ var.Title | regq }}"

; ---------------- FILES ----------------
[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="Open with VS Code"
"Icon"={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | expandsz }}

[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code\command]
@={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | quote | addarg:"%1" | expandsz }}

; ----------------------------DIRECTORIES---------------------------------
; Add "Open with VS Code" for DIRECTORIES (right-click a folder item)
; Key location: HKCU\Software\Classes\Directory\shell\Open_with_VS_Code
; - Uses the selected folder path ("%1").
; ------------------------------------------------------------------------
[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="Open with VS Code"
"Icon"={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | expandsz }}

[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code\command]
@={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | quote | addarg:"%1" | expandsz }}

; ----------------------------FOLDER BACKGROUND---------------------------
; Add "Open with VS Code" for FOLDER BACKGROUND
; (right-click empty space inside a folder)
; Key location: HKCU\Software\Classes\Directory\Background\shell\Open_with_VS_Code
; - Uses the current folder path ("%V").
; ------------------------------------------------------------------------
[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="Open with VS Code"
"Icon"={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | expandsz }}

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code\command]
@={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | quote | addarg:"%V" | expandsz }}

; ------------------------------------------------------------------------
; Note: On Windows 11, classic "shell" items appear under "Show more options".
; To see the item directly in the condensed menu requires a different
; registration model (Explorer Command Handler / COM). This .reg targets
; the classic menu for maximum compatibility.
; ------------------------------------------------------------------------
