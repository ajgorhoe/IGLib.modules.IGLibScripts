Windows Registry Editor Version 5.00

; Adds "Open with VS Code" for files, directories, and folder background
; Uses the current user's profile folder to build an absolute Code.exe path.
; Title is parameterized via {{ var.Title | regq }}.

; -------- FILES --------
[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code]
@="{{ var.Title | regq }}"
"MUIVerb"="{{ var.Title | regq }}"
"Icon"="{{ env.USERPROFILE | pathappend:"\AppData\Local\Programs\Microsoft VS Code\Code.exe" | regq }}"

[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code\command]
@="\"{{ env.USERPROFILE | pathappend:"\AppData\Local\Programs\Microsoft VS Code\Code.exe" | regq }}\" \"%1\""


; -------- DIRECTORIES --------
[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code]
@="{{ var.Title | regq }}"
"MUIVerb"="{{ var.Title | regq }}"
"Icon"="{{ env.USERPROFILE | pathappend:"\AppData\Local\Programs\Microsoft VS Code\Code.exe" | regq }}"

[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code\command]
@="\"{{ env.USERPROFILE | pathappend:"\AppData\Local\Programs\Microsoft VS Code\Code.exe" | regq }}\" \"%1\""


; -------- BACKGROUND (empty space inside a folder) --------
[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code]
@="{{ var.Title | regq }}"
"MUIVerb"="{{ var.Title | regq }}"
"Icon"="{{ env.USERPROFILE | pathappend:"\AppData\Local\Programs\Microsoft VS Code\Code.exe" | regq }}"

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code\command]
@="\"{{ env.USERPROFILE | pathappend:"\AppData\Local\Programs\Microsoft VS Code\Code.exe" | regq }}\" \"%V\""
