Windows Registry Editor Version 5.00

; Example template for adding "Open with VS Code" (current user)
; Uses %LOCALAPPDATA% so paths are per-user; encoded as REG_EXPAND_SZ via \{\{ ... | expandsz \}\}

; Optional variables (uncomment and provide via -Variables / -Var / -VarsFile):
; Title defaults to "Open with VS Code" if you replace below, e.g.:
; [HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code]
; @="{{ var.Title | regq }}"
; "MUIVerb"="{{ var.Title | regq }}"

; ---------------- FILES ----------------
[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="Open with VS Code"
"Icon"={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | expandsz }}

[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code\command]
@={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | quote | addarg:"%1" | expandsz }}

; --------------- DIRECTORIES -----------
[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="Open with VS Code"
"Icon"={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | expandsz }}

[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code\command]
@={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | quote | addarg:"%1" | expandsz }}

; ------------- BACKGROUND --------------
[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="Open with VS Code"
"Icon"={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | expandsz }}

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code\command]
@={{ env.LOCALAPPDATA | pathappend:"\Programs\Microsoft VS Code\Code.exe" | quote | addarg:"%V" | expandsz }}

; Note: Classic menu (Win10/11 "Show more options").
; For the new Win11 condensed menu, use an Explorer command handler registration instead.
