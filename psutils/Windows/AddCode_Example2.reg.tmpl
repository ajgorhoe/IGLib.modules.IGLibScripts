Windows Registry Editor Version 5.00

; ------------------------------------------------------------------------
; Add "Open with VS Code" for FILES (right-click a file)
; Key location: HKCU\Software\Classes\*\shell\Open_with_VS_Code
; - The item key’s default value (@) and MUIVerb both set the label.
; - Icon sets the menu icon.
; - The command’s default value runs Code.exe with the selected file ("%1").
; ------------------------------------------------------------------------
[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code]
@="{{ var.Title | regq }}"
"MUIVerb"="{{ var.Title | regesc }}"
"Icon"="C:\\Users\\{{var.MyUserName}}\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe"

[HKEY_CURRENT_USER\Software\Classes\*\shell\Open_with_VS_Code\command]
@="\"{{ var.VsCodeLocation | regesc }}Code.exe\" \"%1\""


; ------------------------------------------------------------------------
; Add "Open with VS Code" for DIRECTORIES (right-click a folder item)
; Key location: HKCU\Software\Classes\Directory\shell\Open_with_VS_Code
; - Uses the selected folder path ("%1").
; ------------------------------------------------------------------------
[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="{{ var.Title | regesc }}"
"Icon"="C:\\Users\\{{env.USERNAME}}\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe"

[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open_with_VS_Code\command]
@="\"{{ env.LOCALAPPDATA | regesc }}\\Programs\\Microsoft VS Code\\Code.exe\" \"%1\""


; ------------------------------------------------------------------------
; Add "Open with VS Code" for FOLDER BACKGROUND
; (right-click empty space inside a folder)
; Key location: HKCU\Software\Classes\Directory\Background\shell\Open_with_VS_Code
; - Uses the current folder path ("%V").
; ------------------------------------------------------------------------
[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code]
@="Open with VS Code"
"MUIVerb"="{{ var.Title | regesc }}"
"Icon"="C:\\Users\\{{ var.MyUserName }}\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe"

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open_with_VS_Code\command]
@="\"C:\\Users\\{{
    var.MyUserName
    
    }}\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\" \"%V\""


; ------------------------------------------------------------------------
; Note: On Windows 11, classic "shell" items appear under "Show more options".
; To see the item directly in the condensed menu requires a different
; registration model (Explorer Command Handler / COM). This .reg targets
; the classic menu for maximum compatibility.
; ------------------------------------------------------------------------
